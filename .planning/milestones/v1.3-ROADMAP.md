# Roadmap: Twining MCP Server

## Milestones

- âœ… **v1** -- Phases 1-3 (shipped 2026-02-17)
- âœ… **v1.1 Integrations + Polish** -- Phases 4-6 (shipped 2026-02-17)
- âœ… **v1.2 Web Dashboard** -- Phases 7-10 (shipped 2026-02-17)
- âœ… **v1.3 Agent Coordination** -- Phases 11-14 (shipped 2026-02-17)

## Phases

<details>
<summary>âœ… v1 (Phases 1-3) -- SHIPPED 2026-02-17</summary>

- [x] Phase 1: Foundation + Core Data (2/2 plans) -- completed 2026-02-16
- [x] Phase 2: Intelligence (2/2 plans) -- completed 2026-02-16
- [x] Phase 3: Graph + Lifecycle (2/2 plans) -- completed 2026-02-17

</details>

<details>
<summary>âœ… v1.1 Integrations + Polish (Phases 4-6) -- SHIPPED 2026-02-17</summary>

- [x] Phase 4: Git Commit Linking (2/2 plans) -- completed 2026-02-17
- [x] Phase 5: GSD Planning Bridge + Serena Docs (2/2 plans) -- completed 2026-02-17
- [x] Phase 6: Search + Export (2/2 plans) -- completed 2026-02-17

</details>

<details>
<summary>âœ… v1.2 Web Dashboard (Phases 7-10) -- SHIPPED 2026-02-17</summary>

- [x] Phase 7: HTTP Server Foundation (3/3 plans) -- completed 2026-02-17
- [x] Phase 8: Observability Dashboard (2/2 plans) -- completed 2026-02-17
- [x] Phase 9: Search and Filter (2/2 plans) -- completed 2026-02-17
- [x] Phase 10: Visualizations and Polish (3/3 plans) -- completed 2026-02-17

</details>

### ðŸš§ v1.3 Agent Coordination (In Progress)

**Milestone Goal:** Enable agents to discover each other, delegate work through capability-matched needs, and hand off context cleanly between context windows.

- [x] **Phase 11: Types and Storage** - Agent registry and handoff record data models, storage layer, init extensions (completed 2026-02-17)
- [x] **Phase 12: Coordination Engine** - Registration, discovery, delegation matching, and handoff logic (completed 2026-02-17)
- [x] **Phase 13: Tools and Assembly** - MCP tool surface, context assembler integration, status extension (completed 2026-02-17)
- [x] **Phase 14: Agent Dashboard** - API endpoints and Agents tab with registry, delegation, and handoff views (completed 2026-02-17)

## Phase Details

### Phase 11: Types and Storage
**Goal**: Agent and handoff data can be persisted and retrieved reliably
**Depends on**: Phase 10 (existing storage patterns established)
**Requirements**: REG-01, REG-02, REG-03, REG-04, HND-05
**Success Criteria** (what must be TRUE):
  1. Agent records persist to `.twining/agents/registry.json` with agent_id, capabilities, role, description, and timestamps
  2. Handoff records persist to `.twining/handoffs/` as individual JSON files with a JSONL index
  3. Agent liveness status (active/idle/gone) is computable from last_active timestamp with configurable thresholds
  4. `.twining/agents/` and `.twining/handoffs/` directories are auto-created on first use via init extensions
**Plans**: 3 plans
- [ ] 11-01-PLAN.md -- Types, utilities (liveness + tags), init extension, config
- [ ] 11-02-PLAN.md -- AgentStore (TDD)
- [ ] 11-03-PLAN.md -- HandoffStore (TDD)

### Phase 12: Coordination Engine
**Goal**: Agents can register, discover each other by capability, post delegation needs with matching, and create handoffs
**Depends on**: Phase 11
**Requirements**: DEL-01, DEL-02, DEL-03, DEL-06, DEL-07, DEL-08, HND-01, HND-02, HND-04
**Success Criteria** (what must be TRUE):
  1. An agent can discover other agents whose capabilities match a set of required tags, scored by capability overlap and liveness
  2. A delegation need posted to the blackboard returns suggested matching agents ranked by score
  3. Delegation needs support urgency levels and auto-expire after a configurable timeout
  4. A handoff record can be created with results, context snapshot (referenced decision/warning IDs and summaries), and acknowledged by a consumer
**Plans**: 3 plans
Plans:
- [ ] 12-01-PLAN.md -- Types, scoring algorithm, and CoordinationEngine.discover() (TDD)
- [ ] 12-02-PLAN.md -- Delegation posting with urgency-based expiry and agent matching (TDD)
- [ ] 12-03-PLAN.md -- Handoff creation with context snapshot assembly and acknowledgment (TDD)

### Phase 13: Tools and Assembly
**Goal**: Agent coordination is accessible through MCP tools and integrated into context assembly and status
**Depends on**: Phase 12
**Requirements**: DEL-04, DEL-05, HND-03, HND-06
**Success Criteria** (what must be TRUE):
  1. `twining_agents` lists all registered agents with their capabilities and liveness status
  2. `twining_status` includes registered agent count and active agent count
  3. `twining_assemble` includes relevant handoff results in its context output when assembling for a scope
  4. Context assembly suggests available agents with matching capabilities for the current task
**Plans**: 2 plans
Plans:
- [ ] 13-01-PLAN.md -- twining_agents tool + twining_status agent counts (DEL-04, DEL-05)
- [ ] 13-02-PLAN.md -- Context assembler handoff + agent suggestion integration (HND-03, HND-06)

### Phase 14: Agent Dashboard
**Goal**: Agent coordination state is visible and browsable in the web dashboard
**Depends on**: Phase 13
**Requirements**: DASH-01, DASH-02, DASH-03
**Success Criteria** (what must be TRUE):
  1. Dashboard Agents tab shows all registered agents with their status, capabilities, and last activity
  2. Dashboard shows pending delegation needs with which agents match each need
  3. Dashboard shows handoff history with creation time, source/target agents, and acknowledgment status
**Plans**: 2 plans
Plans:
- [ ] 14-01-PLAN.md -- API endpoints for agents, delegations, handoffs + status extension
- [ ] 14-02-PLAN.md -- Frontend Agents tab with 3 sub-views (Agents, Delegations, Handoffs)

## Progress

**Execution Order:**
Phases execute in numeric order: 11 -> 12 -> 13 -> 14

| Phase | Milestone | Plans Complete | Status | Completed |
|-------|-----------|----------------|--------|-----------|
| 1. Foundation + Core Data | v1 | 2/2 | Complete | 2026-02-16 |
| 2. Intelligence | v1 | 2/2 | Complete | 2026-02-16 |
| 3. Graph + Lifecycle | v1 | 2/2 | Complete | 2026-02-17 |
| 4. Git Commit Linking | v1.1 | 2/2 | Complete | 2026-02-17 |
| 5. GSD Planning Bridge + Serena Docs | v1.1 | 2/2 | Complete | 2026-02-17 |
| 6. Search + Export | v1.1 | 2/2 | Complete | 2026-02-17 |
| 7. HTTP Server Foundation | v1.2 | 3/3 | Complete | 2026-02-17 |
| 8. Observability Dashboard | v1.2 | 2/2 | Complete | 2026-02-17 |
| 9. Search and Filter | v1.2 | 2/2 | Complete | 2026-02-17 |
| 10. Visualizations and Polish | v1.2 | 3/3 | Complete | 2026-02-17 |
| 11. Types and Storage | v1.3 | Complete    | 2026-02-17 | - |
| 12. Coordination Engine | v1.3 | Complete    | 2026-02-17 | - |
| 13. Tools and Assembly | v1.3 | Complete    | 2026-02-17 | - |
| 14. Agent Dashboard | v1.3 | Complete    | 2026-02-17 | - |
